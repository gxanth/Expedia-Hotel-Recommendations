<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <style>
    #vis.vega-embed {
      width: 100%;
      display: flex;
    }

    #vis.vega-embed details,
    #vis.vega-embed details summary {
      position: relative;
    }
  </style>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega@5"></script>
  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/vega-embed@6"></script>
</head>
<body>
  <div id="vis"></div>
  <script>
    (function(vegaEmbed) {
      var spec = {"$schema": "https://vega.github.io/schema/vega/v5.json", "data": [{"name": "_server_source_0", "values": [{"bin_center": 45.81565144470424, "column": "price_usd", "rel_freq": 0.003}, {"bin_center": 159.31963273628492, "column": "price_usd", "rel_freq": 0.001}, {"bin_center": 123.84963858266596, "column": "price_usd", "rel_freq": 0.06}, {"bin_center": 109.66164092121838, "column": "price_usd", "rel_freq": 0.134}, {"bin_center": 130.94363741338975, "column": "price_usd", "rel_freq": 0.044}, {"bin_center": 173.50763039773253, "column": "price_usd", "rel_freq": 0.001}, {"bin_center": 116.75563975194217, "column": "price_usd", "rel_freq": 0.092}, {"bin_center": 145.13163507483733, "column": "price_usd", "rel_freq": 0.011}, {"bin_center": 67.09764793687562, "column": "price_usd", "rel_freq": 0.034}, {"bin_center": 74.19164676759941, "column": "price_usd", "rel_freq": 0.062}, {"bin_center": 31.627653783256648, "column": "price_usd", "rel_freq": 0.001}, {"bin_center": 102.56764209049459, "column": "price_usd", "rel_freq": 0.154}, {"bin_center": 81.2856455983232, "column": "price_usd", "rel_freq": 0.094}, {"bin_center": 152.22563390556112, "column": "price_usd", "rel_freq": 0.008}, {"bin_center": 138.03763624411354, "column": "price_usd", "rel_freq": 0.027}, {"bin_center": 60.003649106151826, "column": "price_usd", "rel_freq": 0.017}, {"bin_center": 95.47364325977078, "column": "price_usd", "rel_freq": 0.11800000000000001}, {"bin_center": 88.37964442904699, "column": "price_usd", "rel_freq": 0.134}, {"bin_center": 52.90965027542803, "column": "price_usd", "rel_freq": 0.005}]}, {"name": "param_16_store"}, {"name": "source_0", "source": "_server_source_0", "transform": [{"type": "filter", "expr": "(checkbox_price_usd && (datum.column === 'price_usd'))"}, {"type": "stack", "field": "rel_freq", "groupby": ["bin_center"], "sort": {"field": ["column"], "order": ["descending"]}, "as": ["rel_freq_start", "rel_freq_end"], "offset": "zero"}, {"type": "filter", "expr": "isValid(datum[\"bin_center\"]) && isFinite(+datum[\"bin_center\"]) && isValid(datum[\"rel_freq\"]) && isFinite(+datum[\"rel_freq\"])"}, {"type": "project", "fields": ["bin_center", "column", "rel_freq", "rel_freq_end", "rel_freq_start"]}]}, {"name": "source_0_x_domain_bin_center", "source": "source_0", "transform": [{"type": "formula", "expr": "+datum['bin_center']", "as": "bin_center"}, {"type": "aggregate", "groupby": [], "fields": ["bin_center", "bin_center"], "ops": ["min", "max"], "as": ["min", "max"]}]}, {"name": "source_0_color_domain_column", "source": "source_0", "transform": [{"type": "aggregate", "groupby": ["column"], "fields": [], "ops": [], "as": []}, {"type": "formula", "expr": "datum['column']", "as": "sort_field"}, {"type": "project", "fields": ["column"]}]}], "signals": [{"name": "unit", "value": {}, "on": [{"events": "pointermove", "update": "isTuple(group()) ? group() : unit"}]}, {"name": "param_16", "update": "vlSelectionResolve(\"param_16_store\", \"union\")"}, {"name": "checkbox_price_usd", "value": true, "bind": {"input": "checkbox"}}, {"name": "param_16_bin_center", "on": [{"events": [{"source": "view", "type": "dblclick"}], "update": "null"}, {"events": {"signal": "param_16_translate_delta"}, "update": "panLinear(param_16_translate_anchor.extent_x, -param_16_translate_delta.x / width)"}, {"events": {"signal": "param_16_zoom_delta"}, "update": "zoomLinear(domain(\"x\"), param_16_zoom_anchor.x, param_16_zoom_delta)"}]}, {"name": "param_16_rel_freq", "on": [{"events": [{"source": "view", "type": "dblclick"}], "update": "null"}, {"events": {"signal": "param_16_translate_delta"}, "update": "panLinear(param_16_translate_anchor.extent_y, param_16_translate_delta.y / height)"}, {"events": {"signal": "param_16_zoom_delta"}, "update": "zoomLinear(domain(\"y\"), param_16_zoom_anchor.y, param_16_zoom_delta)"}]}, {"name": "param_16_tuple", "on": [{"events": [{"signal": "param_16_bin_center || param_16_rel_freq"}], "update": "param_16_bin_center && param_16_rel_freq ? {unit: \"\", fields: param_16_tuple_fields, values: [param_16_bin_center,param_16_rel_freq]} : null"}]}, {"name": "param_16_tuple_fields", "value": [{"field": "bin_center", "channel": "x", "type": "R"}, {"field": "rel_freq", "channel": "y", "type": "R"}]}, {"name": "param_16_translate_anchor", "value": {}, "on": [{"events": [{"source": "scope", "type": "pointerdown"}], "update": "{x: x(unit), y: y(unit), extent_x: domain(\"x\"), extent_y: domain(\"y\")}"}]}, {"name": "param_16_translate_delta", "value": {}, "on": [{"events": [{"source": "window", "between": [{"source": "scope", "type": "pointerdown"}, {"source": "window", "type": "pointerup"}], "consume": true, "type": "pointermove"}], "update": "{x: param_16_translate_anchor.x - x(unit), y: param_16_translate_anchor.y - y(unit)}"}]}, {"name": "param_16_zoom_anchor", "on": [{"events": [{"source": "scope", "consume": true, "type": "wheel"}], "update": "{x: invert(\"x\", x(unit)), y: invert(\"y\", y(unit))}"}]}, {"name": "param_16_zoom_delta", "on": [{"events": [{"source": "scope", "consume": true, "type": "wheel"}], "update": "pow(1.001, event.deltaY * pow(16, event.deltaMode))", "force": true}]}, {"name": "param_16_modify", "on": [{"events": {"signal": "param_16_tuple"}, "update": "modify(\"param_16_store\", param_16_tuple, true)"}]}], "marks": [{"type": "rect", "name": "marks", "from": {"data": "source_0"}, "encode": {"update": {"tooltip": {"signal": "{\"column\": isValid(datum[\"column\"]) ? datum[\"column\"] : \"\"+datum[\"column\"], \"bin_center\": format(datum[\"bin_center\"], \"\"), \"rel_freq\": format(datum[\"rel_freq\"], \"\")}"}, "xc": {"field": "bin_center", "scale": "x"}, "width": {"value": 5}, "y2": {"field": "rel_freq_start", "scale": "y"}, "fill": {"field": "column", "scale": "color"}, "opacity": {"value": 0.6}, "y": {"field": "rel_freq_end", "scale": "y"}}}, "style": ["bar"], "clip": true, "interactive": true}], "scales": [{"name": "x", "type": "linear", "domain": [{"signal": "(data(\"source_0_x_domain_bin_center\")[0] || {}).min"}, {"signal": "(data(\"source_0_x_domain_bin_center\")[0] || {}).max"}], "range": [0, {"signal": "width"}], "padding": 5, "zero": false, "nice": true, "domainRaw": {"signal": "param_16[\"bin_center\"]"}}, {"name": "y", "type": "linear", "domain": {"data": "source_0", "fields": ["rel_freq_start", "rel_freq_end"]}, "range": [{"signal": "height"}, 0], "nice": true, "zero": true, "domainRaw": {"signal": "param_16[\"rel_freq\"]"}}, {"name": "color", "type": "ordinal", "domain": {"data": "source_0_color_domain_column", "field": "column", "sort": true}, "range": "category"}], "axes": [{"scale": "x", "maxExtent": 0, "orient": "bottom", "ticks": false, "domain": false, "minExtent": 0, "aria": false, "zindex": 0, "gridScale": "y", "tickCount": {"signal": "ceil(width/40)"}, "grid": true, "labels": false}, {"scale": "y", "tickCount": {"signal": "ceil(height/40)"}, "maxExtent": 0, "aria": false, "ticks": false, "gridScale": "x", "grid": true, "orient": "left", "domain": false, "labels": false, "minExtent": 0, "zindex": 0}, {"scale": "x", "title": "Value", "grid": false, "labelOverlap": true, "orient": "bottom", "zindex": 0, "tickCount": {"signal": "ceil(width/40)"}, "labelFlush": true}, {"scale": "y", "labelOverlap": true, "tickCount": {"signal": "ceil(height/40)"}, "orient": "left", "title": "rel_freq", "grid": false, "zindex": 0}], "style": "cell", "height": 400, "width": 800, "background": "white", "legends": [{"title": "Column", "fill": "color", "symbolType": "square", "encode": {"symbols": {"update": {"opacity": {"value": 0.6}}}}}], "padding": 5};
      var embedOpt = {"mode": "vega"};

      function showError(el, error){
          el.innerHTML = ('<div style="color:red;">'
                          + '<p>JavaScript Error: ' + error.message + '</p>'
                          + "<p>This usually means there's a typo in your chart specification. "
                          + "See the javascript console for the full traceback.</p>"
                          + '</div>');
          throw error;
      }
      const el = document.getElementById('vis');
      vegaEmbed("#vis", spec, embedOpt)
        .catch(error => showError(el, error));
    })(vegaEmbed);

  </script>
</body>
</html>